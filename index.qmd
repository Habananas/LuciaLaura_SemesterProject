---
title: We need a better title
subtitle: Patterns and Trends in Environmental Data
author: Lucia Scheele and Laura Vetter
format:
  html:
    code-fold: true # makes the code in the output collapsable
execute:
  warning: false # hides warnings from the generated output
  message: false        # hides messages from the generated output
lang: en  # switch to "de" if you write your report in german
bibliography: bibliography.bib
---


```{r preprocessing}
#| code-summary: preprocessing
``` 

```{r preprocessing}
install.packages("pacman") 
library("pacman")
p_install_gh("benmarwick/wordcountaddin")
wordcountaddin::word_count("index.qmd")

``` 

## Abstract


BEARBEITEN!

## Introduction

In order to understand travel behaviour, it is critical to analyze movement data and be able to classify different types of movement correctly (Sadeghian et al. 2020). 

In this semester project, movement data collected by two individuals over a three month period is analyzed and compared in order to understand the concepts of segmentation, similarity analysis and k-means clustering and test whether these methods can be applied to human movement data with relatively small coherence within the data sets. 

@laube2011 investigate how temporal scale affects the calculation of movement parameters (speed, sinuosity and turning angle) of animal trajectories. 

... leading to the research question of which travel modes can be differentiated in a collection of trajectories using  k-means clustering?

## Material and Methods


### Data
The data sample consists of movement data collected with the Tracking
App Strava, by two individuals over a timespan of April - May 2024.
Overall, 31 trips of different travel modes were recorded with the movement types walking, running, cycling, bus, tram, train and car. For simplification of the  design and to be able to focus on the application of k-means, a sample of 5 trips will be selected to be analyzed.
Data points were recorded every second, resulting in a relatively high resolution of data. However, data frequency is not consistent in all cases due to lack of signal (e.g. in a train). 

Contextual data that might be used for the analysis is traffic
infrastructure data by the city of Zurich (
[https://www.stadt-zuerich.ch/geodaten/](#0){.uri} ) and the TLM???

BEARBEITEN

### k means 
Some of the trajectories include several travel modes. The aim of this project is to verify if it is possible to detect different travel modes within one trajectory using k means clustering. 
As there are 5 different travel modes present in the 5 samples (walking, running, tram, bike, train), we will start with k=5, and eventually reduce the number of clusters if necessary. 

For this, space and time of trajectories will be treated to be relative .
The parameters for k-means will be calculated from the given geographical data and include:
- distance p1 - p2
- speed p1 - p2
- acceleration p1 - p2
- mean speed in moving window 
- max speed in moving window
- mean acceleration in moving window 
- max acceleration in moving window
- elevation change in moving window 
- sinuosity in moving window
(other experimental stuff like azimuth, direction, turn? how to do that?)

Initially, it was planned to use a k-means algorithm  that takes categorical variables into account (such as infrastructure data), however this was not possible with the k-mode() function and the ... package was not supported by the R-version. 

### classification via decision tree?
-> If time, decision tree?? , PCA (Lucia?), 

### verification
The quality of this analysis is then  assessed by visual analysis and comparison with GIS data. 
Predictive Validation, accuracy, precision, recall, F1 Score, Confusion Matrix..

## Results

### parameters

```{r}
tm_shape(laura_df)+
  tm_dots(col = "speed_kmh", palette = "RdYlGn") 

tm_shape(laura_df)+
  tm_dots(col = "el_change", palette = "RdYlGn") 


tm_shape(laura_df)+
  tm_dots(col = "sinuosity", palette = "RdYlGn",
          n =3 ,
          breaks = seq(0, 3, by = 0.1)) 
```

### applying k means  (non hierarchical clustering)

```{r}
plot_k

```
The optimal number of clusters with the given parameters seems to be  5, when not taking in sinuosity, and 4 with sinuosity.
```{r}
km25

plot_cluster25_5

tm_shape(laura_kmeans)+
  tm_dots(col = "cluster_25_5", palette = "RdYlGn") 

```
Changing the nstart value to 50
```{r}
km50
#fehlt noch
```

Changing the cluster number to 4?
```{r}
km25_4

```

das cluster klappt noch ziemlich schlecht, es clustert zB die standing points gleich wie das laufen. Und Strassenbahn und Fahrrad sind ebenfalls gleich


### hierarchical clustering 
meaning that e.g. cluster bike is closer to running and tram is closer to train 

## Discussion

## Appendix

### Wordcount

<!-- after installing the wordcountadding, remove the line "#| eval: false" -->

```{r}
#| eval: false
wordcountaddin::word_count("index.qmd")
```


